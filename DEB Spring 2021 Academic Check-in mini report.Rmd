---
title: "DEB Spring 2021 Academic Check-in Mini Analysis"
author: "JP Flores"
date: "1/11/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE, include=FALSE}
library(tidyverse)
library(janitor)
library(ggcharts)
library(mdthemes)
library(skimr)
```

This [survey](https://docs.google.com/forms/d/1xsSR3A1MVAz2Ny47aP2rLM1xWB4bqMNMBovbOiUMHxA/edit) was sent out as an anonymous platform for students to share about their academic experiences from last semester, explain ongoing challenges, and help inform faculty about how they can be of better support in the Spring. 

Students were aware that responses may be shared anonymously with faculty members.

As of January 13, 2021, 303 students have filled out the survey.

***

## Sample

This sample is composed of the class of 2021 (28.7%), class of 2022 (20.8%%), class of 2023 (28.7%), and class of 2024 (23%).

```{r echo = FALSE, message=FALSE, results='hide'}
deb_data <- read_csv("~/Desktop/deb_data/DEB Spring 2021 Academic Check-In (Responses) - Form Responses 1.csv") %>% 
  clean_names() 

deb_class <- deb_data %>% 
  select(class_year)

deb_class <- tribble(
  ~class_year, ~pct,
  "2021", 28.7,
  "2022", 20.8,
  "2023", 25.4,
  "2024", 25.1)

deb_class %>%
  mutate(label = sprintf("%1.1f%%", pct)) %>%
  bar_chart(x = class_year, y = pct, bar_color = "orange") +
  geom_text(aes(label = label, hjust = 0), size = 5) +
  scale_y_continuous(
    limits = c(0, 50),
    expand = expansion()
  ) +
  labs(
    x = NULL,
    y = NULL,
    title = "Sample by class year",
    subtitle = "n = 303",
    caption = "Source: DEB Spring 2021 Academic Check-In"
  ) +
  mdthemes::md_theme_classic(base_size = 14) +
  theme(
    axis.text.x = element_blank(),
    axis.line.x = element_blank(),
    axis.ticks.x = element_blank()
  )
```


***
## Demographics

```{r echo = FALSE, message=FALSE, results='hide'}
deb_dems <- deb_data %>% 
  transmute(class = class_year,
            race_ethnicity = race_ethnicity,
         low_income = do_you_identify_as_a_low_income_student,
         lgbtqia = do_you_identify_as_lgbtqia,
         PST = will_you_be_in_pacific_standard_time_pst_during_the_spring_2021_semester,
         first_gen = are_you_a_first_generation_college_student)

deb_dems$class <- as.character(deb_dems$class)

deb_dems$race_ethnicity[107] <- "MENA/SWANA"

deb_dems <- deb_dems %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "American Indian or Alaskan Native, Black or African American, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "American Indian or Alaskan Native, Hispanic or Latinx", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, Black or African American", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Black or African American, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Hispanic or Latinx, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Native Hawaiian or Other Pacific Islander, White", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, White", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Middle Eastern", "MENA/SWANA"))  %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Black or African American, Hispanic or Latinx", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, Multi", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "multiracial", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "ARMENIAN", "MENA/SWANA")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, Hispanic or Latinx, Multi", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "White, MENA/SWANA", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, Hispanic or Latinx", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "SWANA/MENA", "MENA/SWANA")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "North African", "Black or African American")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "International/ Latin American", "Hispanic or Latinx")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "south asian", "Asian")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Coptic", "MENA/SWANA"))


  deb_dems %>% 
  ggplot(aes(x = class, fill = race_ethnicity)) +
  geom_bar() +
  labs(title = "Student Demographics: Race/Ethnicity",
       subtitle = "n = 303",
       caption = "Source: DEB Spring 2021 Academic Check-In") +
    theme(plot.caption = element_text(hjust = 2.5),
          axis.text.x = element_text(angle=45)
  )
```


```{r echo = FALSE, message=FALSE, results='hide'}
  deb_dems %>% 
  ggplot(aes(x = class, fill = race_ethnicity)) +
  geom_bar() +
  facet_wrap( ~ low_income) +
  labs(title = "Student Demographics: Low-income",
       subtitle = "n = 303",
       caption = "Source: DEB Spring 2021 Academic Check-In") +
    theme(plot.caption = element_text(hjust = 2),
          axis.text.x = element_text(angle=45)
  ) 
```



```{r echo = FALSE, message=FALSE, results='hide'}
deb_dems %>% 
  ggplot(aes(x = class, fill = race_ethnicity)) +
  geom_bar() +
  facet_wrap( ~ lgbtqia) +
  labs(title = "Student Demographics: LGBTQIA+",
       subtitle = "n = 120",
       caption = "Source: DEB Spring 2021 Academic Check-In") +
  theme(
  plot.caption = element_text(hjust = 2),
  axis.text.x = element_text(angle=45))

```

```{r echo = FALSE, message=FALSE, results='hide'}
deb_dems %>% 
  ggplot(aes(x = class, fill = race_ethnicity)) +
  geom_bar() +
  facet_wrap( ~ first_gen) +
  labs(title = "Student Demographics: First Generation",
       subtitle = "n = 120",
       caption = "Source: DEB Spring 2021 Academic Check-In") +
  theme(
  plot.caption = element_text(hjust = 2),
  axis.text.x = element_text(angle=45))
```

## Academic Challenges 

```{r echo = FALSE, message=FALSE, results='hide'}
deb_concern <- deb_data %>% 
  transmute(concern = how_concerned_are_you_about_your_academic_success_this_semester)

deb_concern_chart <- tribble(
  ~concern, ~pct,
  "1", 4.1,
  "2", 24.4,
  "3", 24.4,
  "4", 33.3,
  "5", 13.8)

deb_concern_chart %>%
  mutate(label = sprintf("%1.1f%%", pct)) %>%
  bar_chart(x = concern, y = pct, bar_color = "orange") +
  geom_text(aes(label = label, hjust = 0), size = 5) +
  scale_y_continuous(
    limits = c(0, 50),
    expand = expansion()
  ) +
  labs(
    x = NULL,
    y = NULL,
    title = "Concern regarding academic success this semester?",
    subtitle = "scale from 1-5 (5 being extremely concerned)",
    caption = "Source: DEB Spring 2021 Academic Check-In"
  ) +
  mdthemes::md_theme_classic(base_size = 14) +
  theme(
    axis.text.x = element_blank(),
    axis.line.x = element_blank(),
    axis.ticks.x = element_blank()
  )


```

```{r echo = FALSE, message=FALSE, results='hide'}
deb_pace <- deb_data %>% 
  transmute(pace = overall_how_did_you_feel_about_the_pace_of_your_classes_last_semester)

deb_pace_chart <- tribble(
  ~pace, ~pct,
  "1", 0,
  "2", 1.6,
  "3", 48.8,
  "4", 40.7,
  "5", 8.9)

deb_pace_chart %>%
  mutate(label = sprintf("%1.1f%%", pct)) %>%
  bar_chart(x = pace, y = pct, bar_color = "orange") +
  geom_text(aes(label = label, hjust = 0), size = 5) +
  scale_y_continuous(
    limits = c(0, 55),
    expand = expansion()
  ) +
  labs(
    x = NULL,
    y = NULL,
    title = "Concern regarding pace this semester?",
    subtitle = "scale from 1-5 (5 being extremely concerned)",
    caption = "Source: DEB Spring 2021 Academic Check-In"
  ) +
  mdthemes::md_theme_classic(base_size = 14) +
  theme(
    axis.text.x = element_blank(),
    axis.line.x = element_blank(),
    axis.ticks.x = element_blank()
  )


```

```{r echo = FALSE, message=FALSE, results='hide'}
deb_workload <- deb_data %>% 
  transmute(class = class_year,
            race_ethnicity = race_ethnicity,
         low_income = do_you_identify_as_a_low_income_student,
         lgbtqia = do_you_identify_as_lgbtqia,
         PST = will_you_be_in_pacific_standard_time_pst_during_the_spring_2021_semester,
         first_gen = are_you_a_first_generation_college_student,
         workload = overall_how_did_you_feel_about_workload_in_your_classes_last_semester)

deb_workload$class <- as.character(deb_dems$class)

deb_workload$race_ethnicity[107] <- "MENA/SWANA"

deb_workload <- deb_workload %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "American Indian or Alaskan Native, Black or African American, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "American Indian or Alaskan Native, Hispanic or Latinx", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, Black or African American", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Black or African American, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Hispanic or Latinx, White", "Multi")) %>%
  mutate(race_ethnicity = str_replace(race_ethnicity, "Native Hawaiian or Other Pacific Islander, White", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Asian, White", "Multi")) %>% 
  mutate(race_ethnicity = str_replace(race_ethnicity, "Middle Eastern", "MENA/SWANA"))

deb_workload %>% 
  ggplot(aes(x = class, fill = race_ethnicity)) +
  geom_bar() +
  facet_wrap( ~ workload) +
  labs(title = "Academic Challenges: Workload",
       subtitle = "n = 120",
       caption = "Source: DEB Spring 2021 Academic Check-In") +
    theme(plot.caption = element_text(hjust = 2),
          axis.text.x = element_text(angle=45))

```

